# ุฏููู ุงุฎุชุจุงุฑ ุดุงูู: ุฑุญูุฉ ุงูุชูุฒูุน ูููุงุชูุฑ ุงููุจูุนุงุช ุงูููุฒุน

## ๐ ูุธุฑุฉ ุนุงูุฉ

ูุฐุง ุงูุฏููู ููุถุญ ููููุฉ ุงุฎุชุจุงุฑ ุณูุฑ ุงูุนูู ุงููุงูู ูุฑุญูุฉ ุงูุชูุฒูุน ูููุงุชูุฑ ุงููุจูุนุงุช ุงูููุฒุน ุจุงุณุชุฎุฏุงู Postman Collection.

## ๐ฏ ุงููุฏู ูู ุงูุงุฎุชุจุงุฑ

ุงุฎุชุจุงุฑ ุงูุชูุงูู ุงููุงูู ุจูู:
- **ุฑุญูุฉ ุงูุชูุฒูุน** (Distribution Trip)
- **ููุงุชูุฑ ุงููุจูุนุงุช ุงูููุฒุน** (Distributor Sales Invoices)
- **ุฅุฏุงุฑุฉ ุงููุฎุฒูู** (Inventory Management)
- **API ูุงุฆูุฉ ุงูููุชุฌุงุช** (Product SelectList API)

## ๐ ุณููุงุฑูู ุงูุงุฎุชุจุงุฑ ุงููุงูู

### **ุงูุจูุงูุงุช ุงููุทููุจุฉ:**
- ููุธู (Employee)
- ุณูุงุฑุฉ (Car)
- ููุทูุฉ (Region)
- ุนููู (Customer)
- ููุชุฌ ุฌุงูุฒ ููุจูุน (Product)
- ุฑุตูุฏ ุงูููุชุฌ (Product Balance)

### **ุณูุฑ ุงูุนูู:**
1. ุฅูุดุงุก ุฑุญูุฉ ุชูุฒูุน
2. ุชุฑุญูู ุงูุฑุญูุฉ
3. ุงุณุชูุงู ุงูุจุถุงุนุฉ
4. ุฅูุดุงุก ููุงุชูุฑ ูุจูุนุงุช ููุฒุน
5. ุงูุชุญูู ูู ุงููููุงุช
6. ุฅููุงู ุงูุฑุญูุฉ

## ๐ง ุฎุทูุงุช ุงูุงุฎุชุจุงุฑ

### **ุงููุฑุญูุฉ 1: ุฅุนุฏุงุฏ ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ**

#### **1.1 ุฅูุดุงุก ููุธู**
```json
POST /api/Employee/CreateEmployee
{
  "firstName": "ุฃุญูุฏ",
  "lastName": "ูุญูุฏ",
  "phone": "0123456789",
  "email": "ahmed@marketzone.com",
  "address": "ุงููุงูุฑุฉ",
  "isActive": true
}
```
**ุงููุชูุฌุฉ ุงููุชููุนุฉ:** ID = 1

#### **1.2 ุฅูุดุงุก ุณูุงุฑุฉ**
```json
POST /api/Car/CreateCar
{
  "name": "ุณูุงุฑุฉ ุชูุฒูุน 1",
  "plateNumber": "ุฃ ุจ ุฌ 123",
  "model": "2023",
  "year": 2023,
  "capacityKg": 1000,
  "isAvailable": true
}
```
**ุงููุชูุฌุฉ ุงููุชููุนุฉ:** ID = 1

#### **1.3 ุฅูุดุงุก ููุทูุฉ**
```json
POST /api/Region/CreateRegion
{
  "name": "ุงูููุทูุฉ ุงูุดูุงููุฉ",
  "description": "ุชุบุทู ุดูุงู ุงููุงูุฑุฉ",
  "isActive": true
}
```
**ุงููุชูุฌุฉ ุงููุชููุนุฉ:** ID = 1

#### **1.4 ุฅูุดุงุก ุนููู**
```json
POST /api/Customer/CreateCustomer
{
  "name": "ูุญู ุงูุจู ุงูุทุงุฒุฌ",
  "phone": "0987654321",
  "email": "customer1@example.com",
  "address": "ุดุงุฑุน ุงููููุ ุงููุงูุฑุฉ",
  "whatsAppPhone": "0987654321"
}
```
**ุงููุชูุฌุฉ ุงููุชููุนุฉ:** ID = 1

#### **1.5 ุฅูุดุงุก ููุชุฌ ุฌุงูุฒ ููุจูุน**
```json
POST /api/Product/CreateProduct
{
  "categoryId": 1,
  "name": "ุจู ุฃุฑุงุจููุง ูุญูุต",
  "description": "ุจู ุฃุฑุงุจููุง ูุญูุต ุนุงูู ุงูุฌูุฏุฉ",
  "unitOfMeasure": "ูููู",
  "purchasePrice": 20.00,
  "salePrice": 25.50,
  "minStockLevel": 5,
  "isActive": true,
  "needsRoasting": false,
  "roastingCost": null,
  "barCode": "123456789"
}
```
**ุงููุชูุฌุฉ ุงููุชููุนุฉ:** ID = 1

#### **1.6 ุฅูุดุงุก ุฑุตูุฏ ุงูููุชุฌ**
```json
POST /api/ProductBalance/CreateProductBalance
{
  "productId": 1,
  "qty": 200,
  "availableQty": 200
}
```
**ุงููุชูุฌุฉ ุงููุชููุนุฉ:** ID = 1

---

### **ุงููุฑุญูุฉ 2: ุณูุฑ ุนูู ุฑุญูุฉ ุงูุชูุฒูุน**

#### **2.1 ุฅูุดุงุก ุฑุญูุฉ ุชูุฒูุน ุฌุฏูุฏุฉ**
```json
POST /api/DistributionTrip/CreateDistributionTrip
{
  "employeeId": 1,
  "carId": 1,
  "regionId": 1,
  "tripDate": "2025-01-15",
  "loadQty": 100,
  "notes": "ุฑุญูุฉ ุชูุฒูุน ููููุทูุฉ ุงูุดูุงููุฉ - ุงุฎุชุจุงุฑ ุดุงูู",
  "details": [
    {
      "productId": 1,
      "qty": 100,
      "expectedPrice": 25.50
    }
  ]
}
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
- ุฑุญูุฉ ุชูุฒูุน ุฌุฏูุฏุฉ ุจุฑูู ID
- ุญุงูุฉ ุงูุฑุญูุฉ: `Draft`
- `SoldQty` = 0
- `ReturnedQty` = 0
- **AvailableQty ูู ProductBalance ููุตุช ูู 200 ุฅูู 100**

#### **2.2 ุงูุชุญูู ูู ุฑุญูุฉ ุงูุชูุฒูุน ุจุนุฏ ุงูุฅูุดุงุก**
```json
GET /api/DistributionTrip/GetPagedListDistributionTrip?PageNumber=1&PageSize=10
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
```json
{
  "data": [
    {
      "id": 1,
      "employeeId": 1,
      "carId": 1,
      "regionId": 1,
      "tripDate": "2025-01-15T00:00:00",
      "loadQty": 100,
      "notes": "ุฑุญูุฉ ุชูุฒูุน ููููุทูุฉ ุงูุดูุงููุฉ - ุงุฎุชุจุงุฑ ุดุงูู",
      "status": "Draft",
      "details": [
        {
          "id": 1,
          "productId": 1,
          "qty": 100,
          "expectedPrice": 25.50,
          "returnedQty": 0,
          "soldQty": 0
        }
      ]
    }
  ]
}
```

#### **2.3 ุงูุชุญูู ูู ุฑุตูุฏ ุงูููุชุฌ ุจุนุฏ ุฅูุดุงุก ุงูุฑุญูุฉ**
```json
GET /api/ProductBalance/GetByProductId/1
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
```json
{
  "id": 1,
  "productId": 1,
  "qty": 200,        // ูู ูุชุบูุฑ
  "availableQty": 100 // ููุต ูู 200 ุฅูู 100
}
```

#### **2.4 ุชุฑุญูู ุงูุฑุญูุฉ**
```json
PUT /api/DistributionTrip/PostDistributionTrip
{
  "id": 1
}
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
- ุญุงูุฉ ุงูุฑุญูุฉ: `Posted`
- ุงูุฑุญูุฉ ุฌุงูุฒุฉ ููุชูููุฐ

#### **2.5 ุงุณุชูุงู ุงูุจุถุงุนุฉ (ุชุณุฌูู ุงููุฑุชุฌุนุงุช)**
```json
PUT /api/DistributionTrip/ReceiveGoods
{
  "tripId": 1,
  "details": [
    {
      "detailId": 1,
      "returnedQty": 15
    }
  ]
}
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
- ุญุงูุฉ ุงูุฑุญูุฉ: `GoodsReceived`
- `ReturnedQty` = 15
- `SoldQty` = 0 (ูู ูุชู ุฅูุดุงุก ููุงุชูุฑ ุจุนุฏ)

---

### **ุงููุฑุญูุฉ 3: ุฅูุดุงุก ููุงุชูุฑ ุงููุจูุนุงุช ุงูููุฒุน**

#### **3.1 ุฅูุดุงุก ูุงุชูุฑุฉ ูุจูุนุงุช ููุฒุน (ุงูุนููู ุงูุฃูู)**
```json
POST /api/SalesInvoice/CreateSalesInvoice
{
  "invoiceNumber": "INV-DIST-001",
  "customerId": 1,
  "invoiceDate": "2025-01-15",
  "totalAmount": 765.00,
  "discount": 0,
  "paymentMethod": "ููุฏู",
  "notes": "ูุงุชูุฑุฉ ุชูุฒูุน - ุงูุนููู ุงูุฃูู",
  "type": "Distributor",
  "distributionTripId": 1,
  "details": [
    {
      "productId": 1,
      "quantity": 30,
      "unitPrice": 25.50,
      "subTotal": 765.00,
      "notes": "ุทูุจ ุนุงุฏู"
    }
  ]
}
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
- ูุงุชูุฑุฉ ูุจูุนุงุช ุฌุฏูุฏุฉ ุจุฑูู ID
- `SoldQty` ููููุชุฌ ูู ุฑุญูุฉ ุงูุชูุฒูุน = 30
- ุงููุงุชูุฑุฉ ูุฑุชุจุทุฉ ุจุฑุญูุฉ ุงูุชูุฒูุน

#### **3.2 ุงูุชุญูู ูู ุฑุญูุฉ ุงูุชูุฒูุน ุจุนุฏ ุงููุงุชูุฑุฉ ุงูุฃููู**
```json
GET /api/DistributionTrip/GetPagedListDistributionTrip?PageNumber=1&PageSize=10
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
```json
{
  "data": [
    {
      "id": 1,
      "status": "GoodsReceived",
      "details": [
        {
          "id": 1,
          "productId": 1,
          "qty": 100,
          "expectedPrice": 25.50,
          "returnedQty": 15,
          "soldQty": 30  // ุชู ุชุญุฏูุซู
        }
      ]
    }
  ]
}
```

#### **3.3 ุฅูุดุงุก ูุงุชูุฑุฉ ูุจูุนุงุช ููุฒุน (ุงูุนููู ุงูุซุงูู)**
```json
POST /api/SalesInvoice/CreateSalesInvoice
{
  "invoiceNumber": "INV-DIST-002",
  "customerId": 1,
  "invoiceDate": "2025-01-15",
  "totalAmount": 637.50,
  "discount": 0,
  "paymentMethod": "ุดูู",
  "notes": "ูุงุชูุฑุฉ ุชูุฒูุน - ุงูุนููู ุงูุซุงูู",
  "type": "Distributor",
  "distributionTripId": 1,
  "details": [
    {
      "productId": 1,
      "quantity": 25,
      "unitPrice": 25.50,
      "subTotal": 637.50,
      "notes": "ุทูุจ ุนุงุฌู"
    }
  ]
}
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
- ูุงุชูุฑุฉ ูุจูุนุงุช ุฌุฏูุฏุฉ ุจุฑูู ID
- `SoldQty` ููููุชุฌ ูู ุฑุญูุฉ ุงูุชูุฒูุน = 55 (30 + 25)
- ุงููุงุชูุฑุฉ ูุฑุชุจุทุฉ ุจุฑุญูุฉ ุงูุชูุฒูุน

---

### **ุงููุฑุญูุฉ 4: ุงูุชุญูู ูุงูุชุญููู**

#### **4.1 ุงูุชุญูู ูู ุงููููุงุช ูู ุฑุญูุฉ ุงูุชูุฒูุน**
```json
GET /api/DistributionTrip/ValidateTripQuantities?TripId=1
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
```json
{
  "succeeded": true,
  "data": {
    "isValid": true,
    "errors": [],
    "warnings": []
  }
}
```

#### **4.2 ุงูุชุญูู ูู ุฑุญูุฉ ุงูุชูุฒูุน ุงูููุงุฆูุฉ**
```json
GET /api/DistributionTrip/GetPagedListDistributionTrip?PageNumber=1&PageSize=10
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
```json
{
  "data": [
    {
      "id": 1,
      "status": "GoodsReceived",
      "details": [
        {
          "id": 1,
          "productId": 1,
          "qty": 100,        // ูุญูู
          "expectedPrice": 25.50,
          "returnedQty": 15,  // ูุฑุชุฌุน
          "soldQty": 55       // ูุจุงุน (30 + 25)
        }
      ]
    }
  ]
}
```

#### **4.3 ุงูุชุญูู ูู ููุงุชูุฑ ุงููุจูุนุงุช**
```json
GET /api/SalesInvoice/GetPagedListSalesInvoice?PageNumber=1&PageSize=10
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
```json
{
  "data": [
    {
      "id": 1,
      "invoiceNumber": "INV-DIST-001",
      "customerId": 1,
      "type": "Distributor",
      "distributionTripId": 1,
      "totalAmount": 765.00,
      "status": "Draft"
    },
    {
      "id": 2,
      "invoiceNumber": "INV-DIST-002",
      "customerId": 1,
      "type": "Distributor",
      "distributionTripId": 1,
      "totalAmount": 637.50,
      "status": "Draft"
    }
  ]
}
```

---

### **ุงููุฑุญูุฉ 5: ุฅููุงู ุฑุญูุฉ ุงูุชูุฒูุน**

#### **5.1 ุฅููุงู ุฑุญูุฉ ุงูุชูุฒูุน**
```json
PUT /api/DistributionTrip/CompleteTrip
{
  "tripId": 1,
  "details": [
    {
      "detailId": 1,
      "returnedQty": 15
    }
  ]
}
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
- ุญุงูุฉ ุงูุฑุญูุฉ: `Completed`
- ุงูุฑุญูุฉ ููุชููุฉ ุจูุฌุงุญ

#### **5.2 ุงูุชุญูู ูู ุฑุตูุฏ ุงูููุชุฌ ุจุนุฏ ุฅููุงู ุงูุฑุญูุฉ**
```json
GET /api/ProductBalance/GetByProductId/1
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
```json
{
  "id": 1,
  "productId": 1,
  "qty": 145,        // 200 - 55 (ูุจุงุน)
  "availableQty": 115 // 100 + 15 (ูุฑุชุฌุน)
}
```

---

### **ุงููุฑุญูุฉ 6: ุงุฎุชุจุงุฑ API ูุงุฆูุฉ ุงูููุชุฌุงุช**

#### **6.1 ุงูุญุตูู ุนูู ุงูููุชุฌุงุช ุงูุฌุงูุฒุฉ ููุจูุน**
```json
GET /api/Lookup/GetProductSelectListForDistribution
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
```json
{
  "succeeded": true,
  "data": [
    {
      "value": "1",
      "label": "ุจู ุฃุฑุงุจููุง ูุญูุต",
      "qty": 115.00  // ุงููููุฉ ุงููุชุงุญุฉ
    }
  ]
}
```

#### **6.2 ุงูุญุตูู ุนูู ุงูููุชุฌุงุช ุงููุชุจููุฉ ูู ุฑุญูุฉ ุงูุชูุฒูุน**
```json
GET /api/Lookup/GetProductSelectListForDistribution?DistributionTripId=1
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
```json
{
  "succeeded": true,
  "data": [
    {
      "value": "1",
      "label": "ุจู ุฃุฑุงุจููุง ูุญูุต",
      "qty": 30.00  // 100 - 55 - 15 = 30 ูุชุจูู
    }
  ]
}
```

---

## ๐จ ุงุฎุชุจุงุฑ ุงูุญุงูุงุช ุงูุงุณุชุซูุงุฆูุฉ

### **1. ูุญุงููุฉ ุฅูุดุงุก ูุงุชูุฑุฉ ููุฒุน ูุฑุญูุฉ ูู ุญุงูุฉ Draft**
**ุงููุชูุฌุฉ ุงููุชููุนุฉ:** ุฎุทุฃ - "Cannot create distributor invoice for trip that is not in GoodsReceived status"

### **2. ูุญุงููุฉ ุฅูุดุงุก ูุงุชูุฑุฉ ููุฒุน ุจูููุฉ ุชุชุฌุงูุฒ ุงููุญููุฉ**
**ุงููุชูุฌุฉ ุงููุชููุนุฉ:** ุฎุทุฃ - "Sold quantity cannot exceed loaded quantity"

### **3. ูุญุงููุฉ ุฅูุดุงุก ูุงุชูุฑุฉ ููุฒุน ูุฑุญูุฉ ุบูุฑ ููุฌูุฏุฉ**
**ุงููุชูุฌุฉ ุงููุชููุนุฉ:** ุฎุทุฃ - "Distribution trip not found"

---

## ๐ ููุฎุต ุงููุชุงุฆุฌ ุงููุชููุนุฉ

### **ูู ููุงูุฉ ุงูุงุฎุชุจุงุฑ:**

| ุงูุนูุตุฑ | ุงููููุฉ ุงูุฃูููุฉ | ุงููููุฉ ุงูููุงุฆูุฉ | ุงูุชุบููุฑ |
|--------|----------------|-----------------|---------|
| **ProductBalance.Qty** | 200 | 145 | -55 (ูุจุงุน) |
| **ProductBalance.AvailableQty** | 200 | 115 | -85 (ูุญูู) + 15 (ูุฑุชุฌุน) |
| **DistributionTrip.Status** | Draft | Completed | โ ููุชููุฉ |
| **DistributionTripDetail.SoldQty** | 0 | 55 | +55 (ูู ููุงุชูุฑ) |
| **DistributionTripDetail.ReturnedQty** | 0 | 15 | +15 (ูุฑุชุฌุน) |
| **ููุงุชูุฑ ุงููุจูุนุงุช** | 0 | 2 | +2 ูุงุชูุฑุฉ ููุฒุน |

### **ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช:**
- โ ุงููููุฉ ุงููุญููุฉ = ุงููุจุงุนุฉ + ุงููุฑุฌุนุฉ + ุงููุชุจููุฉ (100 = 55 + 15 + 30)
- โ ุงููุฎุฒูู ูุญุฏุซ ุจุดูู ุตุญูุญ
- โ ุงูููุงุชูุฑ ูุฑุชุจุทุฉ ุจุฑุญูุฉ ุงูุชูุฒูุน
- โ ุงููููุงุช ุงููุจุงุนุฉ ูุญุฏุซุฉ ุชููุงุฆูุงู
- โ API ูุงุฆูุฉ ุงูููุชุฌุงุช ูุนูู ุจุดูู ุตุญูุญ

---

## ๐ฏ ูุนุงููุฑ ุงููุฌุงุญ

### **1. ุณูุฑ ุงูุนูู:**
- โ ุฅูุดุงุก ุฑุญูุฉ ุชูุฒูุน ุจูุฌุงุญ
- โ ุชุฑุญูู ุงูุฑุญูุฉ ุจูุฌุงุญ
- โ ุงุณุชูุงู ุงูุจุถุงุนุฉ ุจูุฌุงุญ
- โ ุฅูุดุงุก ููุงุชูุฑ ุงููุจูุนุงุช ุจูุฌุงุญ
- โ ุชุญุฏูุซ ุงููููุงุช ุงููุจุงุนุฉ ุชููุงุฆูุงู
- โ ุงูุชุญูู ูู ุงููููุงุช ุจูุฌุงุญ
- โ ุฅููุงู ุงูุฑุญูุฉ ุจูุฌุงุญ

### **2. ุงูุชุญูู ูู ุงูุฃุฎุทุงุก:**
- โ ุงูุชุญูู ูู ูุฌูุฏ ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ
- โ ุงูุชุญูู ูู ุงููููุงุช ุงููุชุงุญุฉ
- โ ุงูุชุญูู ูู ุญุงูุฉ ุงูุฑุญูุฉ ูู ูู ุฎุทูุฉ
- โ ุงูุชุญูู ูู ุงููููุงุช ุงููุจุงุนุฉ ูุงููุฑุฌุนุฉ
- โ ูุนุงูุฌุฉ ุงูุญุงูุงุช ุงูุงุณุชุซูุงุฆูุฉ

### **3. ุงูุจูุงูุงุช:**
- โ `SoldQty` ุชูุญุฏุซ ุชููุงุฆูุงู ุนูุฏ ุฅูุดุงุก ููุงุชูุฑ ุงููุจูุนุงุช
- โ `ReturnedQty` ุชูุฎุฒู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ ุงูุนูุงูุงุช ุจูู ุงูููุงูุงุช ุชุนูู ุจุดูู ุตุญูุญ
- โ ุงูุชุญูู ูู ุงููููุงุช ูุนูู ุจุดูู ุตุญูุญ
- โ ProductBalance ูุชู ุชุญุฏูุซู ุจุดูู ุตุญูุญ
- โ API ูุงุฆูุฉ ุงูููุชุฌุงุช ูุนูู ุจุดูู ุตุญูุญ

---

*ุชู ุฅุนุฏุงุฏ ูุฐุง ุงูุฏููู ูุงุฎุชุจุงุฑ ุดุงูู ูุฑุญูุฉ ุงูุชูุฒูุน ูููุงุชูุฑ ุงููุจูุนุงุช ุงูููุฒุน*
